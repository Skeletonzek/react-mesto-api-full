(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{20:function(e,t,a){e.exports=a.p+"static/media/mesto.e889e45f.svg"},22:function(e,t,a){e.exports=a.p+"static/media/profile-img.32b3b42c.jpg"},23:function(e,t,a){e.exports=a.p+"static/media/StatusOk.e38b395c.svg"},24:function(e,t,a){e.exports=a.p+"static/media/StatusBad.4072126c.svg"},27:function(e,t,a){e.exports=a(38)},32:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(19),r=a.n(c),i=(a(32),a(25)),s=a(9),l=a(3),u=a(1),p=a(7),m=a(20),f=a.n(m);var _=function(e){var t=Object(u.g)();return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:f.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),o.a.createElement("div",{className:"header__container"},e.isLogged&&o.a.createElement("p",{className:"header__user"},e.email),!e.isLogged&&o.a.createElement(p.b,{to:"/sign-in"===t.pathname?"/sign-up":"/sign-in",className:"header__sign"},"/sign-in"===t.pathname?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u0445\u043e\u0434"),e.isLogged&&o.a.createElement(p.b,{to:"/sign-in",className:"header__sign",onClick:e.onSignOut},"\u0412\u044b\u0439\u0442\u0438")))},d=o.a.createContext();var h=function(e){var t=o.a.useContext(d),a=e.owner===t._id,n=e.likes.some((function(e){return e===t._id})),c="place__bin ".concat(a?" ":"place__bin_hidden"),r="place__like-button ".concat(n?"place__like-button_active":" ");return o.a.createElement("article",{className:"place"},o.a.createElement("button",{className:c,type:"button",onClick:function(){e.onCardDelete(e._id)}}),o.a.createElement("img",{className:"place__photo",alt:e.name,src:e.link,onClick:function(){e.onCardClick(e.name,e.link)}}),o.a.createElement("h2",{className:"place__title"},e.name),o.a.createElement("div",{className:"place__like"},o.a.createElement("button",{className:r,type:"button",onClick:function(){e.onCardLike(e)}}),o.a.createElement("span",{className:"place__like-count"},e.likes.length)))};var g=function(e){var t=o.a.useContext(d);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("button",{className:"profile__img-hover",onClick:e.onEditAvatar},o.a.createElement("img",{className:"profile__img",src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440"})),o.a.createElement("div",{className:"profile-info"},o.a.createElement("h1",{className:"profile-info__name"},t.name),o.a.createElement("button",{className:"profile-info__change",type:"button",onClick:e.onEditProfile}),o.a.createElement("p",{className:"profile-info__status"},t.about)),o.a.createElement("button",{className:"profile__add",type:"button",onClick:e.onAddPlace})),o.a.createElement("section",{className:"places"},e.cards.map((function(t){return o.a.createElement(h,{key:t._id,_id:t._id,name:t.name,link:t.link,likes:t.likes,owner:t.owner,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))};var E=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var b=function(e){var t=o.a.useContext(d),a=o.a.useState(""),n=Object(l.a)(a,2),c=n[0],r=n[1],i=o.a.useState(""),s=Object(l.a)(i,2),u=s[0],p=s[1];return o.a.useEffect((function(){r(t.name),p(t.about)}),[t]),o.a.createElement("section",{className:"popup popup-profile ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("form",{className:"popup__form popup-profile__form",name:"profile",onSubmit:function(t){t.preventDefault(),e.onSubmit({name:c,about:u})},noValidate:!0},o.a.createElement("button",{className:"popup__close popup-profile__close",type:"button",onClick:e.onClose}),o.a.createElement("h2",{className:"popup__title popup-profile__title"},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"),o.a.createElement("input",{className:"popup__text popup-profile__text",value:c,onChange:function(e){r(e.target.value)},id:"name-input",type:"text",name:"name",placeholder:"\u0418\u043c\u044f",minLength:"2",maxLength:"40",required:!0}),o.a.createElement("span",{className:"popup__error",id:"name-input-error"}),o.a.createElement("input",{className:"popup__text popup-profile__text",value:u,onChange:function(e){p(e.target.value)},id:"status-input",type:"text",name:"about",placeholder:"\u041e \u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",required:!0}),o.a.createElement("span",{className:"popup__error",id:"status-input-error"}),o.a.createElement("button",{className:"popup__submit popup-profile__submit",type:"submit"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))};var v=function(e){return o.a.createElement("section",{className:"popup popup-pic ".concat(e.card.open?"popup_opened":"")},o.a.createElement("figure",{className:"popup-pic__figure"},o.a.createElement("button",{className:"popup__close popup-pic__close",type:"button",onClick:e.onClose}),o.a.createElement("img",{className:"popup-pic__img",alt:e.card.name,src:e.card.link}),o.a.createElement("figcaption",{className:"popup-pic__title"},e.card.name)))},N="https://ilyazhulanov.students.nomoreparties.xyz",j=function(){return fetch("".concat(N,"/cards"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))},k=function(){return fetch("".concat(N,"/users/me"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))},C=a(22),y=a.n(C);var S=function(e){var t=o.a.useRef();return o.a.useEffect((function(){e.isOpen&&(t.current.value="")}),[e.isOpen]),o.a.createElement("section",{className:"popup popup-avatar ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("form",{className:"popup__form popup-avatar__form",name:"avatar",onSubmit:function(a){a.preventDefault(),e.onSubmit({avatar:t.current.value})},noValidate:!0},o.a.createElement("button",{className:"popup__close popup-avatar__close",type:"button",onClick:e.onClose}),o.a.createElement("h2",{className:"popup__title popup-avatar__title"},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"),o.a.createElement("input",{ref:t,className:"popup__text popup-avatar__text",id:"link-input",type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),o.a.createElement("span",{className:"popup__error",id:"link-input-error"}),o.a.createElement("button",{className:"popup__submit popup-avatar__submit",type:"submit"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))};var O=function(e){var t=o.a.useRef(),a=o.a.useRef();return o.a.useEffect((function(){e.isOpen&&(t.current.value="",a.current.value="")}),[e.isOpen]),o.a.createElement("section",{className:"popup popup-card ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("form",{className:"popup__form popup-card__form",name:"card",onSubmit:function(n){n.preventDefault(),e.onSubmit({name:t.current.value,link:a.current.value})},noValidate:!0},o.a.createElement("button",{className:"popup__close popup-card__close",type:"button",onClick:e.onClose}),o.a.createElement("h2",{className:"popup__title popup-card__title"},"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e"),o.a.createElement("input",{ref:t,className:"popup__text popup-card__text",id:"title-input",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"1",maxLength:"30",required:!0}),o.a.createElement("span",{className:"popup__error",id:"title-input-error"}),o.a.createElement("input",{ref:a,className:"popup__text popup-card__text",id:"link-input",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),o.a.createElement("span",{className:"popup__error",id:"link-input-error"}),o.a.createElement("button",{className:"popup__submit popup-card__submit",type:"submit"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")))};var x=function(e){var t=o.a.useRef(),a=o.a.useRef();return o.a.createElement("section",{className:"sign sign-up"},o.a.createElement("form",{className:"sign__form sign-up__form",name:"sign-up",onSubmit:function(n){n.preventDefault(),e.onRegister(a.current.value,t.current.value)},noValidate:!0},o.a.createElement("h2",{className:"sign__title sign-up__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("input",{ref:t,className:"sign__text sign-up__text",id:"email-input",type:"email",name:"email",placeholder:"Email",minLength:"2",maxLength:"40",required:!0}),o.a.createElement("input",{ref:a,className:"sign__text sign-up__text",id:"password-input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"200",required:!0}),o.a.createElement("button",{className:"sign__submit sign-up__submit",type:"submit"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement("p",{className:"sign-up__alrdy-user"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0",o.a.createElement(p.b,{to:"/sign-in",className:"sign-up__enter"},"\u0412\u043e\u0439\u0442\u0438"))))};var w=function(e){var t=o.a.useRef(),a=o.a.useRef();return o.a.createElement("section",{className:"sign sign-in"},o.a.createElement("form",{className:"sign__form sign-in__form",name:"sign-in",onSubmit:function(n){n.preventDefault(),e.onLogin(a.current.value,t.current.value)},noValidate:!0},o.a.createElement("h2",{className:"sign__title sign-in__title"},"\u0412\u0445\u043e\u0434"),o.a.createElement("input",{ref:t,className:"sign__text sign-in__text",id:"email-input",type:"email",name:"email",placeholder:"Email",minLength:"2",maxLength:"40",required:!0}),o.a.createElement("input",{ref:a,className:"sign__text sign-in__text",id:"password-input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"200",required:!0}),o.a.createElement("button",{className:"sign__submit sign-in__submit",type:"submit"},"\u0412\u043e\u0439\u0442\u0438")))},L=a(23),P=a.n(L),T=a(24),I=a.n(T);var A=function(e){return o.a.createElement("section",{className:"popup popup-tooltip ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__form popup-tooltip__form"},o.a.createElement("button",{className:"popup__close popup-tooltip__close",type:"button",onClick:e.onClose}),o.a.createElement("img",{className:"popup-tooltip__status-img",alt:"\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",src:e.tooltipStatus?P.a:I.a}),o.a.createElement("p",{className:"popup-tooltip__status-text"},e.tooltipStatus?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")))},z=a(26),B=function(e){var t=e.component,a=Object(z.a)(e,["component"]);return o.a.createElement(u.b,null,(function(){return a.loggedIn?o.a.createElement(t,a):o.a.createElement(u.a,{to:"/sign-in"})}))},D="https://ilyazhulanov.students.nomoreparties.xyz";var R=function(){var e=Object(u.f)(),t=o.a.useState(!1),a=Object(l.a)(t,2),n=a[0],c=a[1],r=o.a.useState(!0),p=Object(l.a)(r,2),m=p[0],f=p[1],h=o.a.useState(!1),C=Object(l.a)(h,2),L=C[0],P=C[1],T=o.a.useState(!1),I=Object(l.a)(T,2),z=I[0],R=I[1],q=o.a.useState(!1),J=Object(l.a)(q,2),V=J[0],H=J[1],M=o.a.useState({name:null,link:null,open:!1}),W=Object(l.a)(M,2),G=W[0],U=W[1],$=o.a.useState({name:"\u0416\u0430\u043a-\u0418\u0432 \u041a\u0443\u0441\u0442\u043e",about:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u043a\u0435\u0430\u043d\u0430",avatar:y.a}),F=Object(l.a)($,2),K=F[0],Q=F[1],X=o.a.useState(!1),Y=Object(l.a)(X,2),Z=Y[0],ee=Y[1],te=o.a.useState(""),ae=Object(l.a)(te,2),ne=ae[0],oe=ae[1];function ce(e){ee(!0),oe(e)}function re(e){c(!0),f(e)}function ie(){H(!1),R(!1),P(!1),U(Object(s.a)(Object(s.a)({},G),{},{open:!1}))}o.a.useEffect((function(){if(localStorage.getItem("jwt")){var t=localStorage.getItem("jwt");(a=t,fetch("".concat(D,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){return e}))).then((function(t){ce(t.data.email),e.push("/")})).catch((function(e){console.error("".concat(e," - \u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0435\u043d"))}))}var a;k().then((function(e){Q(e)})).catch((function(e){console.log(e)}))}),[]);var se=o.a.useState([]),le=Object(l.a)(se,2),ue=le[0],pe=le[1];return o.a.useEffect((function(){j().then((function(e){pe(e)})).catch((function(e){console.log(e)}))}),[]),o.a.createElement(d.Provider,{value:K},o.a.createElement("div",{className:"page"},o.a.createElement(b,{isOpen:L,onClose:ie,onSubmit:function(e){var t;(t=e,console.log(localStorage.getItem("jwt")),fetch("".concat(N,"/users/me"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({name:t.name,about:t.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))).then((function(){Q(Object(s.a)(Object(s.a)({},K),{},{name:e.name,about:e.about})),ie()})).catch((function(e){console.log(e)}))}}),o.a.createElement(O,{isOpen:z,onClose:ie,onSubmit:function(e){var t;(t=e,fetch("".concat(N,"/cards"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({name:t.name,link:t.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))).then((function(e){pe([e].concat(Object(i.a)(ue))),ie()})).catch((function(e){console.log(e)}))}}),o.a.createElement(S,{isOpen:V,onClose:ie,onSubmit:function(e){var t;(t=e,fetch("".concat(N,"/users/me/avatar"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({avatar:t.avatar})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))).then((function(){Q(Object(s.a)(Object(s.a)({},K),{},{avatar:e.avatar})),ie()})).catch((function(e){console.log(e)}))}}),o.a.createElement(v,{card:G,onClose:ie}),o.a.createElement(A,{isOpen:n,onClose:function(){c(!1),m&&e.push("/sign-in")},tooltipStatus:m}),o.a.createElement(_,{isLogged:Z,email:ne,onSignOut:function(){console.log(localStorage.getItem("jwt")),localStorage.removeItem("jwt"),ee(!1)}}),o.a.createElement(B,{path:"/",loggedIn:Z,component:g,cards:ue,onCardLike:function(e){var t=e.likes.some((function(e){return e===K._id}));(function(e,t){return fetch("".concat(N,"/cards/").concat(e,"/likes"),{method:"".concat(t?"DELETE":"PUT"),headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))})(e._id,t).then((function(t){var a=ue.map((function(a){return a._id===e._id?t:a}));pe(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){(function(e){return fetch("".concat(N,"/cards/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.data}))})(e).then((function(){var t=ue.filter((function(t){return t._id!==e}));pe(t)})).catch((function(e){console.log(e)}))},onEditProfile:function(){P(!0)},onAddPlace:function(){R(!0)},onEditAvatar:function(){H(!0)},onCardClick:function(e,t){U({name:e,link:t,open:!0})}}),o.a.createElement(u.b,{path:"/sign-up"},o.a.createElement(x,{onRegister:function(e,t){(function(e,t){return fetch("".concat(D,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){return e}))})(e,t).then((function(e){e&&re(!0)})).catch((function(e){re(!1),console.error("".concat(e," - \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"))}))}})),o.a.createElement(u.b,{path:"/sign-in"},o.a.createElement(w,{onLogin:function(t,a){(function(e,t){return fetch("".concat(D,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e}))})(t,a).then((function(t){t&&(ce(a),j().then((function(e){pe(e)})).catch((function(e){console.log(e)})),k().then((function(e){Q(e)})).catch((function(e){console.log(e)})),e.push("/"))})).catch((function(e){re(!1),400===e?console.error("".concat(e," - \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439")):console.error("".concat(e," - \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))}))}})),o.a.createElement(E,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(p.a,null,o.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.cade0d05.chunk.js.map